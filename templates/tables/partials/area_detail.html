{% load i18n %}

<!-- OOB Tabbar Update -->
<ion-footer hx-swap-oob="innerHTML:#section-tabbar">
{% include "tables/partials/tabbar.html" with current_view='areas' %}
</ion-footer>

<ion-content class="ion-padding">
    <!-- Header -->
    <div class="flex items-center gap-4 mb-6">
        <ion-button
            fill="clear"
            hx-get="{% url 'tables:area_list' %}"
            hx-target="#dashboard-content"
            hx-push-url="true">
            <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
        </ion-button>
        <div class="flex items-center gap-3 flex-grow">
            <div class="w-12 h-12 rounded-lg flex items-center justify-center"
                 style="background-color: {{ area.color }}20; color: {{ area.color }}">
                <ion-icon name="{{ area.icon }}" class="text-2xl"></ion-icon>
            </div>
            <div>
                <h1 class="text-2xl font-bold text-gray-900">{{ area.name }}</h1>
                <p class="text-gray-500">{{ area.table_count }} {% trans "tables" %}</p>
            </div>
        </div>
        <ion-button
            fill="outline"
            hx-get="{% url 'tables:area_edit' pk=area.pk %}"
            hx-target="#dashboard-content"
            hx-push-url="true">
            <ion-icon slot="start" name="create-outline"></ion-icon>
            {% trans "Edit" %}
        </ion-button>
    </div>

    <!-- Area Info -->
    <ion-card class="mb-4">
        <ion-card-content>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                <div>
                    <div class="text-2xl font-bold text-gray-800">{{ area.table_count }}</div>
                    <div class="text-sm text-gray-500">{% trans "Total Tables" %}</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-green-600">{{ area.available_count }}</div>
                    <div class="text-sm text-gray-500">{% trans "Available" %}</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-red-600">{{ area.occupied_count }}</div>
                    <div class="text-sm text-gray-500">{% trans "Occupied" %}</div>
                </div>
                <div>
                    <div class="text-sm text-gray-400">{% trans "Order" %}</div>
                    <div class="text-2xl font-bold text-gray-600">{{ area.order }}</div>
                </div>
            </div>
        </ion-card-content>
    </ion-card>

    <!-- Tables in this area -->
    <ion-card>
        <ion-card-header>
            <ion-card-title>{% trans "Tables" %}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3">
                {% for table in tables %}
                <div class="table-card border-2 rounded-lg p-3 text-center
                    {% if table.status == 'available' %}bg-green-50 border-green-400{% endif %}
                    {% if table.status == 'occupied' %}bg-red-50 border-red-400{% endif %}
                    {% if table.status == 'reserved' %}bg-yellow-50 border-yellow-400{% endif %}
                    {% if table.status == 'blocked' %}bg-gray-100 border-gray-400{% endif %}">
                    <div class="text-2xl font-bold">{{ table.number }}</div>
                    <div class="text-xs text-gray-500">
                        <ion-icon name="people"></ion-icon> {{ table.capacity }}
                    </div>
                    <div class="text-xs uppercase mt-1
                        {% if table.status == 'available' %}text-green-600{% endif %}
                        {% if table.status == 'occupied' %}text-red-600{% endif %}
                        {% if table.status == 'reserved' %}text-yellow-600{% endif %}
                        {% if table.status == 'blocked' %}text-gray-500{% endif %}">
                        {{ table.get_status_display }}
                    </div>
                </div>
                {% empty %}
                <div class="col-span-full text-center py-8 text-gray-500">
                    {% trans "No tables in this area" %}
                </div>
                {% endfor %}
            </div>
        </ion-card-content>
    </ion-card>

    <!-- Delete Button -->
    <div class="mt-6 text-center">
        {% if not tables %}
        <form method="post"
            hx-post="{% url 'tables:area_delete' pk=area.pk %}"
            hx-confirm="{% trans 'Are you sure you want to delete this area?' %}">
            {% csrf_token %}
            <ion-button fill="outline" color="danger" type="submit">
                <ion-icon slot="start" name="trash-outline"></ion-icon>
                {% trans "Delete Area" %}
            </ion-button>
        </form>
        {% else %}
        <p class="text-sm text-gray-500">
            {% trans "Remove all tables from this area before deleting it." %}
        </p>
        {% endif %}
    </div>
</ion-content>
